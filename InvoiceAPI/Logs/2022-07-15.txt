2022-07-15 13:04:05,679 [9] INFO InvoiceAPI.LoggerManager - App  Info - Lo que se enviará al timbrado con Diverza. Usuario: admin. Contenido: {"credentials": {"id":"123414","token": "$2b$12$JgIf1J7db4e6f06VnNPsUOaQD3SpwUnzPqXDkuirQklcc8gMCMIDS" },"issuer": {"rfc": "EKU9003173C9"},"receiver": {"emails": [{"email": "micorreo@hotmail.com","format":"xml+pdf","template": "letter"}]},"document": {"ref-id": "EKU9003173C9A09315200","certificate-number": "30001000000400002434","section": "all","format": "xml","template": "letter","type": "application/vnd.diverza.cfdi_4.0+xml","content": "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48Y2ZkaTpDb21wcm9iYW50ZSB4bWxuczpjZmRpPSJodHRwOi8vd3d3LnNhdC5nb2IubXgvY2ZkLzQiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL3d3dy5zYXQuZ29iLm14L2NmZC80IGh0dHA6Ly93d3cuc2F0LmdvYi5teC9zaXRpb19pbnRlcm5ldC9jZmQvNC9jZmR2NDAueHNkIiBWZXJzaW9uPSI0LjAiIFNlcmllPSJBIiBGb2xpbz0iMDkzMTUyMDAiIEZlY2hhPSIyMDIyLTA3LTE0VDEyOjI2OjA4IiBGb3JtYVBhZ289IjAzIiBOb0NlcnRpZmljYWRvPSIzMDAwMTAwMDAwMDQwMDAwMjQzNCIgU3ViVG90YWw9IjQxMTcxLjA4IiBNb25lZGE9Ik1YTiIgVG90YWw9IjQ3NzU4LjQ1IiBUaXBvRGVDb21wcm9iYW50ZT0iSSIgRXhwb3J0YWNpb249IjAxIiBNZXRvZG9QYWdvPSJQVUUiIEx1Z2FyRXhwZWRpY2lvbj0iMDY1MDAiIENlcnRpZmljYWRvPSJNSUlGdXpDQ0E2T2dBd0lCQWdJVU16QXdNREV3TURBd01EQTBNREF3TURJME16UXdEUVlKS29aSWh2Y05BUUVMQlFBd2dnRXJNUTh3RFFZRFZRUUREQVpCUXlCVlFWUXhMakFzQmdOVkJBb01KVk5GVWxaSlEwbFBJRVJGSUVGRVRVbE9TVk5VVWtGRFNVOU9JRlJTU1VKVlZFRlNTVUV4R2pBWUJnTlZCQXNNRVZOQlZDMUpSVk1nUVhWMGFHOXlhWFI1TVNnd0pnWUpLb1pJaHZjTkFRa0JGaGx2YzJOaGNpNXRZWEowYVc1bGVrQnpZWFF1WjI5aUxtMTRNUjB3R3dZRFZRUUpEQlF6Y21FZ1kyVnljbUZrWVNCa1pTQmpZV1JwZWpFT01Bd0dBMVVFRVF3Rk1EWXpOekF4Q3pBSkJnTlZCQVlUQWsxWU1Sa3dGd1lEVlFRSURCQkRTVlZFUVVRZ1JFVWdUVVZZU1VOUE1SRXdEd1lEVlFRSERBaERUMWxQUVVOQlRqRVJNQThHQTFVRUxSTUlNaTQxTGpRdU5EVXhKVEFqQmdrcWhraUc5dzBCQ1FJVEZuSmxjM0J2Ym5OaFlteGxPaUJCUTBSTlFTMVRRVlF3SGhjTk1Ua3dOakUzTVRrME5ERTBXaGNOTWpNd05qRTNNVGswTkRFMFdqQ0I0akVuTUNVR0ExVUVBeE1lUlZORFZVVk1RU0JMUlUxUVJWSWdWVkpIUVZSRklGTkJJRVJGSUVOV01TY3dKUVlEVlFRcEV4NUZVME5WUlV4QklFdEZUVkJGVWlCVlVrZEJWRVVnVTBFZ1JFVWdRMVl4SnpBbEJnTlZCQW9USGtWVFExVkZURUVnUzBWTlVFVlNJRlZTUjBGVVJTQlRRU0JFUlNCRFZqRWxNQ01HQTFVRUxSTWNSVXRWT1RBd016RTNNME01SUM4Z1dFbFJRamc1TVRFeE5sRkZOREVlTUJ3R0ExVUVCUk1WSUM4Z1dFbFJRamc1TVRFeE5rMUhVazFhVWpBMU1SNHdIQVlEVlFRTEV4VkZjMk4xWld4aElFdGxiWEJsY2lCVmNtZGhkR1V3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ04wcGVLcGdmT0w3NWlZUnYxZnFxK29WWXNMUFZVUi9HaWJZbUdLYzlJbkhGeTVsWUY2T1RZam5JSXZta09kUm9iYkdsQ1V4T1JYL3RMc2w4WWE5Z202WW83aEhuT0RSQklEdXAzR0lTRnpCLzk2UjlLL016WVFPY3NjTUlvQkRBUmF5Y25Mdnk3RmxNdk83L3JsVm5zU0FSeFpSTzhLejhaa2tzajJ6cGVZcGpaSXlhLzM2OStvR3FRazFjVFJrSG81OUp2SjRUZmJrLzNpSXlmNEgvSW5pOW5CZTljWVdvME1uS29iN0REdC92c2RpNXRBOG1NdEE5NTNMYXBOeUNaSURDUlFRbFVHTmdEcVk5LzhGNW1VdlZna2NjenNJZ0dkdmY5dk1RUFNmM2pqQ2lLajdqNnVjeGwxK0Z3SldtYnZnTm1pYVVSLzBxNG0ycm03OGxGQWdNQkFBR2pIVEFiTUF3R0ExVWRFd0VCL3dRQ01BQXdDd1lEVlIwUEJBUURBZ2JBTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCY3BqMVRqVDRqaWluSXVqSWRBbEZ6RTZrUndZSkNuREcwOHpTcDRrU25TaGp4QURHRVhIMmNoZWhLTVYwRlk3YzRuakE1ZURHZEEvRzJPQ1RQdkY1cnBlQ1pQNUR3NTA0UlprWURsMnN1Unord2Exc05CVnBibkJKRUswZlFjTjNJZnRCd3NnTkZkRmhVdEN5dzNsdXMxU1NKYlB4akxIUzZGY1paNTFZU2VJZmNOWE9BdVRxZGltdXNhWHExNUdyU3JDT2tNNm4yamZqMnNNSllNMkhYYVhKNnJHVEVnWW1oWWR3eFd0aWw2UmZaQitmR1EvSDlJOVdMbmw0S1RaVVM2QzkrTkxIaDRGUERoU2sxOWZwUzJTLzU2YXFnRm9HQWtYQVl0OUZ5NUVDYVBjVUxJZkoxREVic1hLeVJkQ3YzSlk4OSswTU5rT2RhRG5zZW1TMm81R2wwOHpJNGlZdHQzTDQwZ0FaNjBOUGgzMWtWTG5ZTnNtdmZOeFl5S3ArQWVKdERIeVc5dzdmdE0wSG9pK0J1Um1jQVFTS0ZWM3BrOGo1MWxhK2pyUkJyQVV2OGJsYlJjUTVCaVpVd0p6SEZFS0l3VHNSR29SeUV4OTZzTm5CMDNuNkdUd2pJR3o5MlNtTGRObDk1cjlya3ZwKzJtNFM2cTFsUHVYYUZnN0RHQnJYV0M4aXlxZVdFMmlvYmR3SUl1WFBUTVZxUWIxMm0xZEFrSlZSTzVOZEhuUC9NcHFPdk9nTHFvWkJOSEd5Qmc0R3FtNHNDSkhDeEExYzhFbGZhMlJRVENrMHRBemxsTDR2T25JMUdIa0dKbjY1eG9rR3NhVTRCNEQzNnhoN2VXcmZqNC9wZ1dIbXRvREFZYTh3elN3bzJHVkNaT3MrbXRFZ09RQjkxL2c9PSIgU2VsbG89Ilk2MWV6ZENiaTRmOWZ2c1ZER3FBbjRxcFU5UGJPSUNpejFyT3NqSjFPYzV1a3U2Zk5pall4MTEvaDA2SlVIQnMxQzNydm42TVFsMTB1R0dDcEk3NTNDV3ZjVDZSOWN1UGNiSHZZWkdQaXdJMWMxaW1BZEF2ZUNRWlBtLzFFZjVzT2pvdHlvQTdIZDFsTFc1RlFvOFk0Ym9ZTHUvYzhzTmErUzBJWmRWT29jTVJPcDMrVkJ6K0VoOXZ5SjVYNHFCbGl0ekFqQTJwVll5VXFOc2U4bEhFUG51YXdHeEl4TDh6T0NKZ0pvZ3QzYU96UEloKy9OUmloUEhJbTl5ZndsUDJodHljU3NPY2Q5Q2hKNkZaZk5yNlY3SjNNSnlrMWFSWDBFUEh4M0xZL2hhRWJZbXdlSElxaHU5MUZTdVQ1WjdkSmQxZXFOcFlOZHM3YXo3QmE1bG5Xdz09Ij48Y2ZkaTpFbWlzb3IgUmZjPSJFS1U5MDAzMTczQzkiIE5vbWJyZT0iRVNDVUVMQSBLRU1QRVIgVVJHQVRFIFNBIERFIENWIiBSZWdpbWVuRmlzY2FsPSI2MDEiIC8+PGNmZGk6UmVjZXB0b3IgUmZjPSJQV0UxMDExMjVLSjYiIE5vbWJyZT0iUEFOIFdFQkVSJmFwb3M7IFMiIERvbWljaWxpb0Zpc2NhbFJlY2VwdG9yPSIyMjQzMCIgUmVnaW1lbkZpc2NhbFJlY2VwdG9yPSI2MDEiIFVzb0NGREk9IkcwMyIgLz48Y2ZkaTpDb25jZXB0b3M+PGNmZGk6Q29uY2VwdG8gQ2xhdmVQcm9kU2Vydj0iODAxMjE2MDQiIENhbnRpZGFkPSIxLjAwIiBDbGF2ZVVuaWRhZD0iRTQ4IiBVbmlkYWQ9IkFDVCIgRGVzY3JpcGNpb249IkRlcmVjaG8gZGUgcGF0ZW50ZXMsIG1hcmNhcyBvIGRlcmVjaG9zIGRlIGF1dG9yIiBWYWxvclVuaXRhcmlvPSI0MTE3MS4wOCIgSW1wb3J0ZT0iNDExNzEuMDgiIE9iamV0b0ltcD0iMDIiPjxjZmRpOkltcHVlc3Rvcz48Y2ZkaTpUcmFzbGFkb3M+PGNmZGk6VHJhc2xhZG8gQmFzZT0iNDExNzEuMDgiIEltcHVlc3RvPSIwMDIiIFRpcG9GYWN0b3I9IlRhc2EiIFRhc2FPQ3VvdGE9IjAuMTYwMDAwIiBJbXBvcnRlPSI2NTg3LjM3IiAvPjwvY2ZkaTpUcmFzbGFkb3M+PC9jZmRpOkltcHVlc3Rvcz48L2NmZGk6Q29uY2VwdG8+PC9jZmRpOkNvbmNlcHRvcz48Y2ZkaTpJbXB1ZXN0b3MgVG90YWxJbXB1ZXN0b3NUcmFzbGFkYWRvcz0iNjU4Ny4zNyI+PGNmZGk6VHJhc2xhZG9zPjxjZmRpOlRyYXNsYWRvIEJhc2U9IjQxMTcxLjA4IiBJbXB1ZXN0bz0iMDAyIiBUaXBvRmFjdG9yPSJUYXNhIiBUYXNhT0N1b3RhPSIwLjE2MDAwMCIgSW1wb3J0ZT0iNjU4Ny4zNyIgLz48L2NmZGk6VHJhc2xhZG9zPjwvY2ZkaTpJbXB1ZXN0b3M+PC9jZmRpOkNvbXByb2JhbnRlPg=="}} 
2022-07-15 13:05:35,425 [9] INFO InvoiceAPI.LoggerManager - App  Info - Envío a timbrar con Diverza.  
2022-07-15 13:08:52,326 [9] INFO InvoiceAPI.LoggerManager - App  Info - Request enviado: System.Net.Http.StringContent 
2022-07-15 13:09:23,449 [9] INFO InvoiceAPI.LoggerManager - App  Info - Response recibido: StatusCode: 400, ReasonPhrase: 'Bad Request', Version: 1.1, Content: System.Net.Http.HttpConnection+HttpConnectionResponseContent, Headers:
{
  Date: Fri, 15 Jul 2022 18:09:22 GMT
  Server: Cowboy
  Cache-Control: must-revalidate, max-age=0, private
  X-Request-ID: et3t8gvupve7n4elltt4pucr8cfkvkos
  Connection: close
  Content-Length: 1758
  Content-Type: application/json; charset=utf-8
} 
2022-07-15 13:27:57,297 [9] INFO InvoiceAPI.LoggerManager - App  Info - Error de respuesta del timbrado Diverza: [{"sat_error_message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","sat_error_code":"CFDI40144","message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","field":"ReceptorNombre","code":1450},{"sat_error_message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","sat_error_code":"CFDI40145","message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","field":"ReceptorNombre","code":1450}] 
2022-07-15 13:27:58,554 [9] INFO InvoiceAPI.LoggerManager - App  Info - Detalle de error de respuesta del timbrado Diverza: Method: POST, RequestUri: 'https://serviciosdemo.diverza.com/api/v2/documents/stamp', Version: 2.0, Content: System.Net.Http.StringContent, Headers:
{
  Content-Type: application/json
  Content-Length: 5415
} 
2022-07-15 13:29:13,634 [9] ERROR InvoiceAPI.LoggerManager - App  Error - No se pudo realizar el timbrado con Diverza.  
2022-07-15 13:29:18,413 [9] ERROR InvoiceAPI.LoggerManager - App  Error - código: ***DIVERZA CODE: 400 
2022-07-15 13:29:24,077 [9] ERROR InvoiceAPI.LoggerManager - App  Error - detalle: ***DIVERZA DETAILS***: Method: POST, RequestUri: 'https://serviciosdemo.diverza.com/api/v2/documents/stamp', Version: 2.0, Content: System.Net.Http.StringContent, Headers:
{
  Content-Type: application/json
  Content-Length: 5415
} 
2022-07-15 13:29:28,122 [9] ERROR InvoiceAPI.LoggerManager - App  Error - message: ***DIVERZA MESSAGE***: [{"sat_error_message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","sat_error_code":"CFDI40144","message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","field":"ReceptorNombre","code":1450},{"sat_error_message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","sat_error_code":"CFDI40145","message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","field":"ReceptorNombre","code":1450}] 
2022-07-15 13:29:33,615 [9] INFO InvoiceAPI.LoggerManager - App  Prepara el envío para timbrar con Luna.  
2022-07-15 13:29:36,307 [9] INFO InvoiceAPI.LoggerManager - App  Info - Envío a timbrar el documento con Luna.  
2022-07-15 13:30:44,789 [9] INFO InvoiceAPI.LoggerManager - App  Info - Solicitud enviada. Request: SW.Services.Stamp.Stamp 
2022-07-15 13:30:54,334 [9] INFO InvoiceAPI.LoggerManager - App  Info - Respuesta recibida. Request: Unauthorized 
2022-07-15 13:31:32,503 [9] ERROR InvoiceAPI.LoggerManager - App  Error - No se pudo realizar el timbrado con LUNA.  
2022-07-15 13:31:38,029 [9] ERROR InvoiceAPI.LoggerManager - App  Error - código: error 
2022-07-15 13:31:51,826 [9] ERROR InvoiceAPI.LoggerManager - App  Error - detalle: 401 
2022-07-15 13:32:10,769 [9] ERROR InvoiceAPI.LoggerManager - App  Error - message: Unauthorized 
2022-07-15 13:40:29,589 [10] INFO InvoiceAPI.LoggerManager - App  Usuario que solicita el proceso: admin 
2022-07-15 13:40:47,938 [10] INFO InvoiceAPI.LoggerManager - App  Info - Proceso de digestión el archivo con el número de certificado: 30001000000400002434 
2022-07-15 13:42:49,588 [10] INFO InvoiceAPI.LoggerManager - App  Info - El proceso de digestion fue correcto.  
2022-07-15 13:45:39,227 [10] INFO InvoiceAPI.LoggerManager - App  Info - Búsqueda del comprobante en la base de datos. 
2022-07-15 13:46:14,668 [10] INFO InvoiceAPI.LoggerManager - App  Info - Datos del comprobante. Folio: 09315200, Número de serie del certificado: 30001000000400002434, rfc: EKU9003173C9, Serie: A 
2022-07-15 13:46:19,109 [10] INFO InvoiceAPI.LoggerManager - App  Antes de pasar valor de Oracle o SQL:  1 
2022-07-15 13:47:20,198 [10] INFO InvoiceAPI.LoggerManager - App  Prepara el envío para timbrar con Diverza.  
2022-07-15 13:48:01,407 [10] INFO InvoiceAPI.LoggerManager - App  Info - Lo que se enviará al timbrado con Diverza. Usuario: admin. Contenido: {"credentials": {"id":"123414","token": "$2b$12$JgIf1J7db4e6f06VnNPsUOaQD3SpwUnzPqXDkuirQklcc8gMCMIDS" },"issuer": {"rfc": "EKU9003173C9"},"receiver": {"emails": [{"email": "micorreo@hotmail.com","format":"xml+pdf","template": "letter"}]},"document": {"ref-id": "EKU9003173C9A09315200","certificate-number": "30001000000400002434","section": "all","format": "xml","template": "letter","type": "application/vnd.diverza.cfdi_4.0+xml","content": "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48Y2ZkaTpDb21wcm9iYW50ZSB4bWxuczpjZmRpPSJodHRwOi8vd3d3LnNhdC5nb2IubXgvY2ZkLzQiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL3d3dy5zYXQuZ29iLm14L2NmZC80IGh0dHA6Ly93d3cuc2F0LmdvYi5teC9zaXRpb19pbnRlcm5ldC9jZmQvNC9jZmR2NDAueHNkIiBWZXJzaW9uPSI0LjAiIFNlcmllPSJBIiBGb2xpbz0iMDkzMTUyMDAiIEZlY2hhPSIyMDIyLTA3LTE0VDEyOjI2OjA4IiBGb3JtYVBhZ289IjAzIiBOb0NlcnRpZmljYWRvPSIzMDAwMTAwMDAwMDQwMDAwMjQzNCIgU3ViVG90YWw9IjQxMTcxLjA4IiBNb25lZGE9Ik1YTiIgVG90YWw9IjQ3NzU4LjQ1IiBUaXBvRGVDb21wcm9iYW50ZT0iSSIgRXhwb3J0YWNpb249IjAxIiBNZXRvZG9QYWdvPSJQVUUiIEx1Z2FyRXhwZWRpY2lvbj0iMDY1MDAiIENlcnRpZmljYWRvPSJNSUlGdXpDQ0E2T2dBd0lCQWdJVU16QXdNREV3TURBd01EQTBNREF3TURJME16UXdEUVlKS29aSWh2Y05BUUVMQlFBd2dnRXJNUTh3RFFZRFZRUUREQVpCUXlCVlFWUXhMakFzQmdOVkJBb01KVk5GVWxaSlEwbFBJRVJGSUVGRVRVbE9TVk5VVWtGRFNVOU9JRlJTU1VKVlZFRlNTVUV4R2pBWUJnTlZCQXNNRVZOQlZDMUpSVk1nUVhWMGFHOXlhWFI1TVNnd0pnWUpLb1pJaHZjTkFRa0JGaGx2YzJOaGNpNXRZWEowYVc1bGVrQnpZWFF1WjI5aUxtMTRNUjB3R3dZRFZRUUpEQlF6Y21FZ1kyVnljbUZrWVNCa1pTQmpZV1JwZWpFT01Bd0dBMVVFRVF3Rk1EWXpOekF4Q3pBSkJnTlZCQVlUQWsxWU1Sa3dGd1lEVlFRSURCQkRTVlZFUVVRZ1JFVWdUVVZZU1VOUE1SRXdEd1lEVlFRSERBaERUMWxQUVVOQlRqRVJNQThHQTFVRUxSTUlNaTQxTGpRdU5EVXhKVEFqQmdrcWhraUc5dzBCQ1FJVEZuSmxjM0J2Ym5OaFlteGxPaUJCUTBSTlFTMVRRVlF3SGhjTk1Ua3dOakUzTVRrME5ERTBXaGNOTWpNd05qRTNNVGswTkRFMFdqQ0I0akVuTUNVR0ExVUVBeE1lUlZORFZVVk1RU0JMUlUxUVJWSWdWVkpIUVZSRklGTkJJRVJGSUVOV01TY3dKUVlEVlFRcEV4NUZVME5WUlV4QklFdEZUVkJGVWlCVlVrZEJWRVVnVTBFZ1JFVWdRMVl4SnpBbEJnTlZCQW9USGtWVFExVkZURUVnUzBWTlVFVlNJRlZTUjBGVVJTQlRRU0JFUlNCRFZqRWxNQ01HQTFVRUxSTWNSVXRWT1RBd016RTNNME01SUM4Z1dFbFJRamc1TVRFeE5sRkZOREVlTUJ3R0ExVUVCUk1WSUM4Z1dFbFJRamc1TVRFeE5rMUhVazFhVWpBMU1SNHdIQVlEVlFRTEV4VkZjMk4xWld4aElFdGxiWEJsY2lCVmNtZGhkR1V3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ04wcGVLcGdmT0w3NWlZUnYxZnFxK29WWXNMUFZVUi9HaWJZbUdLYzlJbkhGeTVsWUY2T1RZam5JSXZta09kUm9iYkdsQ1V4T1JYL3RMc2w4WWE5Z202WW83aEhuT0RSQklEdXAzR0lTRnpCLzk2UjlLL016WVFPY3NjTUlvQkRBUmF5Y25Mdnk3RmxNdk83L3JsVm5zU0FSeFpSTzhLejhaa2tzajJ6cGVZcGpaSXlhLzM2OStvR3FRazFjVFJrSG81OUp2SjRUZmJrLzNpSXlmNEgvSW5pOW5CZTljWVdvME1uS29iN0REdC92c2RpNXRBOG1NdEE5NTNMYXBOeUNaSURDUlFRbFVHTmdEcVk5LzhGNW1VdlZna2NjenNJZ0dkdmY5dk1RUFNmM2pqQ2lLajdqNnVjeGwxK0Z3SldtYnZnTm1pYVVSLzBxNG0ycm03OGxGQWdNQkFBR2pIVEFiTUF3R0ExVWRFd0VCL3dRQ01BQXdDd1lEVlIwUEJBUURBZ2JBTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCY3BqMVRqVDRqaWluSXVqSWRBbEZ6RTZrUndZSkNuREcwOHpTcDRrU25TaGp4QURHRVhIMmNoZWhLTVYwRlk3YzRuakE1ZURHZEEvRzJPQ1RQdkY1cnBlQ1pQNUR3NTA0UlprWURsMnN1Unord2Exc05CVnBibkJKRUswZlFjTjNJZnRCd3NnTkZkRmhVdEN5dzNsdXMxU1NKYlB4akxIUzZGY1paNTFZU2VJZmNOWE9BdVRxZGltdXNhWHExNUdyU3JDT2tNNm4yamZqMnNNSllNMkhYYVhKNnJHVEVnWW1oWWR3eFd0aWw2UmZaQitmR1EvSDlJOVdMbmw0S1RaVVM2QzkrTkxIaDRGUERoU2sxOWZwUzJTLzU2YXFnRm9HQWtYQVl0OUZ5NUVDYVBjVUxJZkoxREVic1hLeVJkQ3YzSlk4OSswTU5rT2RhRG5zZW1TMm81R2wwOHpJNGlZdHQzTDQwZ0FaNjBOUGgzMWtWTG5ZTnNtdmZOeFl5S3ArQWVKdERIeVc5dzdmdE0wSG9pK0J1Um1jQVFTS0ZWM3BrOGo1MWxhK2pyUkJyQVV2OGJsYlJjUTVCaVpVd0p6SEZFS0l3VHNSR29SeUV4OTZzTm5CMDNuNkdUd2pJR3o5MlNtTGRObDk1cjlya3ZwKzJtNFM2cTFsUHVYYUZnN0RHQnJYV0M4aXlxZVdFMmlvYmR3SUl1WFBUTVZxUWIxMm0xZEFrSlZSTzVOZEhuUC9NcHFPdk9nTHFvWkJOSEd5Qmc0R3FtNHNDSkhDeEExYzhFbGZhMlJRVENrMHRBemxsTDR2T25JMUdIa0dKbjY1eG9rR3NhVTRCNEQzNnhoN2VXcmZqNC9wZ1dIbXRvREFZYTh3elN3bzJHVkNaT3MrbXRFZ09RQjkxL2c9PSIgU2VsbG89Ilk2MWV6ZENiaTRmOWZ2c1ZER3FBbjRxcFU5UGJPSUNpejFyT3NqSjFPYzV1a3U2Zk5pall4MTEvaDA2SlVIQnMxQzNydm42TVFsMTB1R0dDcEk3NTNDV3ZjVDZSOWN1UGNiSHZZWkdQaXdJMWMxaW1BZEF2ZUNRWlBtLzFFZjVzT2pvdHlvQTdIZDFsTFc1RlFvOFk0Ym9ZTHUvYzhzTmErUzBJWmRWT29jTVJPcDMrVkJ6K0VoOXZ5SjVYNHFCbGl0ekFqQTJwVll5VXFOc2U4bEhFUG51YXdHeEl4TDh6T0NKZ0pvZ3QzYU96UEloKy9OUmloUEhJbTl5ZndsUDJodHljU3NPY2Q5Q2hKNkZaZk5yNlY3SjNNSnlrMWFSWDBFUEh4M0xZL2hhRWJZbXdlSElxaHU5MUZTdVQ1WjdkSmQxZXFOcFlOZHM3YXo3QmE1bG5Xdz09Ij48Y2ZkaTpFbWlzb3IgUmZjPSJFS1U5MDAzMTczQzkiIE5vbWJyZT0iRVNDVUVMQSBLRU1QRVIgVVJHQVRFIFNBIERFIENWIiBSZWdpbWVuRmlzY2FsPSI2MDEiIC8+PGNmZGk6UmVjZXB0b3IgUmZjPSJQV0UxMDExMjVLSjYiIE5vbWJyZT0iUEFOIFdFQkVSJmFwb3M7IFMiIERvbWljaWxpb0Zpc2NhbFJlY2VwdG9yPSIyMjQzMCIgUmVnaW1lbkZpc2NhbFJlY2VwdG9yPSI2MDEiIFVzb0NGREk9IkcwMyIgLz48Y2ZkaTpDb25jZXB0b3M+PGNmZGk6Q29uY2VwdG8gQ2xhdmVQcm9kU2Vydj0iODAxMjE2MDQiIENhbnRpZGFkPSIxLjAwIiBDbGF2ZVVuaWRhZD0iRTQ4IiBVbmlkYWQ9IkFDVCIgRGVzY3JpcGNpb249IkRlcmVjaG8gZGUgcGF0ZW50ZXMsIG1hcmNhcyBvIGRlcmVjaG9zIGRlIGF1dG9yIiBWYWxvclVuaXRhcmlvPSI0MTE3MS4wOCIgSW1wb3J0ZT0iNDExNzEuMDgiIE9iamV0b0ltcD0iMDIiPjxjZmRpOkltcHVlc3Rvcz48Y2ZkaTpUcmFzbGFkb3M+PGNmZGk6VHJhc2xhZG8gQmFzZT0iNDExNzEuMDgiIEltcHVlc3RvPSIwMDIiIFRpcG9GYWN0b3I9IlRhc2EiIFRhc2FPQ3VvdGE9IjAuMTYwMDAwIiBJbXBvcnRlPSI2NTg3LjM3IiAvPjwvY2ZkaTpUcmFzbGFkb3M+PC9jZmRpOkltcHVlc3Rvcz48L2NmZGk6Q29uY2VwdG8+PC9jZmRpOkNvbmNlcHRvcz48Y2ZkaTpJbXB1ZXN0b3MgVG90YWxJbXB1ZXN0b3NUcmFzbGFkYWRvcz0iNjU4Ny4zNyI+PGNmZGk6VHJhc2xhZG9zPjxjZmRpOlRyYXNsYWRvIEJhc2U9IjQxMTcxLjA4IiBJbXB1ZXN0bz0iMDAyIiBUaXBvRmFjdG9yPSJUYXNhIiBUYXNhT0N1b3RhPSIwLjE2MDAwMCIgSW1wb3J0ZT0iNjU4Ny4zNyIgLz48L2NmZGk6VHJhc2xhZG9zPjwvY2ZkaTpJbXB1ZXN0b3M+PC9jZmRpOkNvbXByb2JhbnRlPg=="}} 
2022-07-15 13:48:01,423 [10] INFO InvoiceAPI.LoggerManager - App  Info - Envío a timbrar con Diverza.  
2022-07-15 13:48:01,424 [10] INFO InvoiceAPI.LoggerManager - App  Info - Request enviado: System.Net.Http.StringContent 
2022-07-15 13:48:02,277 [10] INFO InvoiceAPI.LoggerManager - App  Info - Response recibido: StatusCode: 400, ReasonPhrase: 'Bad Request', Version: 1.1, Content: System.Net.Http.HttpConnection+HttpConnectionResponseContent, Headers:
{
  Date: Fri, 15 Jul 2022 18:48:02 GMT
  Server: Cowboy
  Cache-Control: must-revalidate, max-age=0, private
  X-Request-ID: 2rl5needdciqqhpdm4fvqqgjctd4q2du
  Connection: close
  Content-Length: 1758
  Content-Type: application/json; charset=utf-8
} 
2022-07-15 13:48:02,293 [10] INFO InvoiceAPI.LoggerManager - App  Info - Error de respuesta del timbrado Diverza: [{"sat_error_message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","sat_error_code":"CFDI40144","message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","field":"ReceptorNombre","code":1450},{"sat_error_message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","sat_error_code":"CFDI40145","message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","field":"ReceptorNombre","code":1450}] 
2022-07-15 13:48:02,295 [10] INFO InvoiceAPI.LoggerManager - App  Info - Detalle de error de respuesta del timbrado Diverza: Method: POST, RequestUri: 'https://serviciosdemo.diverza.com/api/v2/documents/stamp', Version: 2.0, Content: System.Net.Http.StringContent, Headers:
{
  Content-Type: application/json
  Content-Length: 5415
} 
2022-07-15 13:48:27,116 [10] ERROR InvoiceAPI.LoggerManager - App  Error - No se pudo realizar el timbrado con Diverza.  
2022-07-15 13:48:27,121 [10] ERROR InvoiceAPI.LoggerManager - App  Error - código: ***DIVERZA CODE: 400 
2022-07-15 13:48:27,125 [10] ERROR InvoiceAPI.LoggerManager - App  Error - detalle: ***DIVERZA DETAILS***: Method: POST, RequestUri: 'https://serviciosdemo.diverza.com/api/v2/documents/stamp', Version: 2.0, Content: System.Net.Http.StringContent, Headers:
{
  Content-Type: application/json
  Content-Length: 5415
} 
2022-07-15 13:48:27,131 [10] ERROR InvoiceAPI.LoggerManager - App  Error - message: ***DIVERZA MESSAGE***: [{"sat_error_message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","sat_error_code":"CFDI40144","message":"El campo Nombre del receptor, debe encontrarse en la lista de RFC inscritos no cancelados en el SAT.","field":"ReceptorNombre","code":1450},{"sat_error_message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","sat_error_code":"CFDI40145","message":"El campo Nombre del receptor, debe pertenecer al nombre asociado al RFC registrado en el campo Rfc del Receptor.","field":"ReceptorNombre","code":1450}] 
2022-07-15 13:48:27,131 [10] INFO InvoiceAPI.LoggerManager - App  Prepara el envío para timbrar con Luna.  
2022-07-15 13:48:27,145 [10] INFO InvoiceAPI.LoggerManager - App  Info - Envío a timbrar el documento con Luna.  
2022-07-15 13:48:31,566 [10] INFO InvoiceAPI.LoggerManager - App  Info - Solicitud enviada. Request: SW.Services.Stamp.Stamp 
2022-07-15 13:48:31,572 [10] INFO InvoiceAPI.LoggerManager - App  Info - Respuesta recibida. Request: Unauthorized 
2022-07-15 13:48:49,930 [10] ERROR InvoiceAPI.LoggerManager - App  Error - No se pudo realizar el timbrado con LUNA.  
2022-07-15 13:48:51,286 [10] ERROR InvoiceAPI.LoggerManager - App  Error - código: error 
2022-07-15 13:48:54,100 [10] ERROR InvoiceAPI.LoggerManager - App  Error - detalle: 401 
2022-07-15 13:48:57,473 [10] ERROR InvoiceAPI.LoggerManager - App  Error - message: Unauthorized 
2022-07-15 17:29:12,068 [21] INFO InvoiceAPI.LoggerManager - App  Usuario que solicita el proceso: admin 
2022-07-15 17:29:59,254 [21] INFO InvoiceAPI.LoggerManager - App  Info - Proceso de digestión el archivo con el número de certificado: 30001000000400002434 
2022-07-15 17:33:51,066 [21] INFO InvoiceAPI.LoggerManager - App  Info - El proceso de digestion fue correcto.  
2022-07-15 17:38:24,889 [21] INFO InvoiceAPI.LoggerManager - App  Info - Búsqueda del comprobante en la base de datos. 
2022-07-15 17:38:28,030 [21] INFO InvoiceAPI.LoggerManager - App  Info - Datos del comprobante. Folio: 09315200, Número de serie del certificado: 30001000000400002434, rfc: EKU9003173C9, Serie: A 
2022-07-15 17:38:28,035 [21] INFO InvoiceAPI.LoggerManager - App  Antes de pasar valor de Oracle o SQL:  1 
2022-07-15 17:40:05,478 [21] INFO InvoiceAPI.LoggerManager - App  Prepara el envío para timbrar con Diverza.  
2022-07-15 17:41:02,869 [21] ERROR InvoiceAPI.LoggerManager - App  Error - Ocurrió un error al intentar timbrar con Diverza.  
2022-07-15 17:41:04,056 [21] ERROR InvoiceAPI.LoggerManager - App  Error - Mensaje: Data at the root level is invalid. Line 1, position 1. 
2022-07-15 17:41:04,971 [21] ERROR InvoiceAPI.LoggerManager - App  Error - StackTrace:    at System.Xml.XmlTextReaderImpl.Throw(Exception e)
   at System.Xml.XmlTextReaderImpl.Throw(String res, String arg)
   at System.Xml.XmlTextReaderImpl.ParseRootLevelWhitespace()
   at System.Xml.XmlTextReaderImpl.ParseDocumentContent()
   at System.Xml.XmlTextReaderImpl.Read()
   at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)
   at System.Xml.XmlDocument.Load(XmlReader reader)
   at System.Xml.XmlDocument.LoadXml(String xml)
   at InvoiceAPI.Controllers.InvoicesController.PrepareEnvioTimbrarDiverza(String xmlSellado, String usuario) in C:\Users\Administrator\source\repos\InvoiceAPI_4.0_adicion\InvoiceAPI\Controllers\InvoicesController.cs:line 483 
2022-07-15 17:41:44,684 [36] INFO InvoiceAPI.LoggerManager - App  Usuario que solicita el proceso: admin 
2022-07-15 17:42:43,510 [36] INFO InvoiceAPI.LoggerManager - App  Info - Proceso de digestión el archivo con el número de certificado: 30001000000400002434 
2022-07-15 17:43:30,855 [36] INFO InvoiceAPI.LoggerManager - App  Info - El proceso de digestion fue correcto.  
2022-07-15 17:45:31,705 [36] INFO InvoiceAPI.LoggerManager - App  Info - Búsqueda del comprobante en la base de datos. 
2022-07-15 17:45:38,109 [36] INFO InvoiceAPI.LoggerManager - App  Info - Datos del comprobante. Folio: 09315200, Número de serie del certificado: 30001000000400002434, rfc: EKU9003173C9, Serie: A 
2022-07-15 17:45:38,111 [36] INFO InvoiceAPI.LoggerManager - App  Antes de pasar valor de Oracle o SQL:  1 
2022-07-15 17:47:04,493 [36] INFO InvoiceAPI.LoggerManager - App  Prepara el envío para timbrar con Diverza.  
2022-07-15 17:52:51,117 [36] ERROR InvoiceAPI.LoggerManager - App  Error - Ocurrió un error al intentar timbrar con Diverza.  
2022-07-15 17:52:52,454 [36] ERROR InvoiceAPI.LoggerManager - App  Error - Mensaje: Data at the root level is invalid. Line 1, position 1. 
2022-07-15 17:52:54,055 [36] ERROR InvoiceAPI.LoggerManager - App  Error - StackTrace:    at System.Xml.XmlTextReaderImpl.Throw(Exception e)
   at System.Xml.XmlTextReaderImpl.Throw(String res, String arg)
   at System.Xml.XmlTextReaderImpl.ParseRootLevelWhitespace()
   at System.Xml.XmlTextReaderImpl.ParseDocumentContent()
   at System.Xml.XmlTextReaderImpl.Read()
   at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)
   at System.Xml.XmlDocument.Load(XmlReader reader)
   at System.Xml.XmlDocument.LoadXml(String xml)
   at InvoiceAPI.Controllers.InvoicesController.PrepareEnvioTimbrarDiverza(String xmlSellado, String usuario) in C:\Users\Administrator\source\repos\InvoiceAPI_4.0_adicion\InvoiceAPI\Controllers\InvoicesController.cs:line 483 
